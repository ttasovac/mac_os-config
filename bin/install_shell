#! /usr/bin/env bash

# Install dotfiles

# Use Homebrew bash

if [[ -z $(cat /etc/shells | grep "$(get_homebrew_bin_root)/bash") ]]; then
  sudo bash -c "printf '$(get_homebrew_bin_root)/bash\n' >> /etc/shells"
  chsh -s "$(get_homebrew_bin_root)/bash"
fi

# Dotfiles set up

if [ -x "$(command -v fish)" ]; then

  rm -Rf $HOME/.config/fish
  mkdir -p $HOME/Development/ttasovac-own
  echo "Moving to ttasovac-own..."
  cd $HOME/Development/ttasovac-own
  echo "Cloning dotfiles..."
  git clone git@github.com:ttasovac/dotfiles.git

  ln -s $HOME/Development/ttasovac-own/dotfiles/fish $HOME/.config/fish
 
  rm -Rf $HOME/.bashrc
  rm -Rf $HOME/.bash
  rm -f $HOME/.bash_profile
 
  ln -s $HOME/Development/ttasovac-own/dotfiles/.bashrc $HOME/.bashrc
  ln -s $HOME/Development/ttasovac-own/dotfiles/.bash $HOME/.bash
  ln -s $HOME/Development/ttasovac-own/dotfiles/.bash_profile $HOME/.bash_profile

  if [[ -z $(cat /etc/shells | grep "$(get_homebrew_bin_root)/fish") ]]; then
    sudo bash -c "printf '$(get_homebrew_bin_root)/fish\n' >> /etc/shells"
    chsh -s "$(get_homebrew_bin_root)/fish"
  fi
  printf "%s\n" "Dotfiles are installed."

  echo "Setting fish as default shell..."
  chsh -s "$(get_homebrew_bin_root)/fish"

else
    echo "To set up dotfiles, make sure you've installed fish (with brew)."
    exit
fi


# TODO in fish
# i think fish setup is completely saved now in dotfiles
# if not, consider
# tide configure --auto --style=Rainbow --prompt_colors='True color'
# --show_time='24-hour format' --rainbow_prompt_separators=Vertical
# --powerline_prompt_heads=Sharp --powerline_prompt_tails=Flat
# --powerline_prompt_style='Two lines, character and frame'
# --prompt_connection=Disconnected --powerline_right_prompt_frame=Yes
# --prompt_connection_andor_frame_color=Darkest --prompt_spacing=Compact
# --icons='Few icons' --transient=No
# after installing 
